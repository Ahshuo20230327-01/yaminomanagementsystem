<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FF14 ç™¾è¬äºç±³è«¾æ—…åœ˜ | Team Allocator</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&family=Roboto:wght@400;500;700&family=Roboto+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #131314;
            --surface-color: #1E1F20;
            --primary-color: #A8C7FA;
            --on-surface: #E3E3E3;
            --secondary-text: #C4C7C5;
            --border-color: #444746;
            --btn-hover: #2B2C2E;
            --tank-color: #669df6;
            --healer-color: #81c995;
            --dps-color: #f28b82;
        }

        body {
            font-family: 'Roboto', 'Noto Sans TC', sans-serif;
            background-color: var(--bg-color);
            color: var(--on-surface);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
            margin-top: 20px;
        }

        h1 {
            font-size: 1.8rem;
            font-weight: 500;
            margin: 0;
            letter-spacing: 1px;
            background: linear-gradient(90deg, #4285F4, #9B72CB, #D96570);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .subtitle {
            color: var(--secondary-text);
            font-size: 0.9rem;
            margin-top: 8px;
            opacity: 0.8;
        }

        .container {
            display: flex;
            flex-wrap: wrap;
            gap: 24px;
            max-width: 1000px;
            width: 100%;
            justify-content: center;
        }

        .card {
            background-color: var(--surface-color);
            border-radius: 24px;
            padding: 24px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.2);
            flex: 1;
            min-width: 320px;
            border: 1px solid transparent;
            transition: border-color 0.3s;
        }

        .card:hover { border-color: #555; }

        h2 {
            font-size: 1.2rem;
            margin-top: 0;
            margin-bottom: 20px;
            color: var(--on-surface);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .input-group {
            background-color: #28292A;
            border-radius: 50px;
            padding: 8px 16px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        input[type="number"] {
            background: transparent;
            border: none;
            color: var(--on-surface);
            font-size: 1.1rem;
            width: 50px;
            text-align: right;
            outline: none;
        }

        .roster-list { display: flex; flex-direction: column; gap: 8px; }

        .roster-item {
            display: flex;
            align-items: center;
            padding: 8px 12px;
            border-radius: 12px;
            transition: background 0.2s;
        }
        .roster-item:hover { background-color: var(--btn-hover); }

        .custom-checkbox {
            appearance: none;
            background-color: transparent;
            margin: 0;
            width: 20px;
            height: 20px;
            border: 2px solid var(--secondary-text);
            border-radius: 4px;
            display: grid;
            place-content: center;
            cursor: pointer;
            margin-right: 12px;
        }
        .custom-checkbox::before {
            content: "";
            width: 10px;
            height: 10px;
            transform: scale(0);
            transition: 120ms transform ease-in-out;
            box-shadow: inset 1em 1em var(--bg-color);
            transform-origin: center;
            clip-path: polygon(14% 44%, 0 65%, 50% 100%, 100% 16%, 80% 0%, 43% 62%);
        }
        .custom-checkbox:checked {
            background-color: var(--primary-color);
            border-color: var(--primary-color);
        }
        .custom-checkbox:checked::before { transform: scale(1); }

        .name-label { flex: 1; font-size: 1rem; cursor: pointer; color: var(--on-surface); }

        .role-selector {
            display: flex; gap: 4px; background: #28292A; border-radius: 50px; padding: 2px;
        }
        .role-btn {
            cursor: pointer; padding: 4px 12px; border-radius: 50px; color: var(--secondary-text);
            font-size: 0.8rem; font-weight: 500; transition: all 0.2s;
        }
        input[type="radio"] { display: none; }
        
        input[value="T"]:checked + span { background-color: rgba(102, 157, 246, 0.2); color: var(--tank-color); }
        input[value="H"]:checked + span { background-color: rgba(129, 201, 149, 0.2); color: var(--healer-color); }
        input[value="D"]:checked + span { background-color: rgba(242, 139, 130, 0.2); color: var(--dps-color); }

        .manual-input {
            background: transparent; border: none; border-bottom: 1px solid var(--secondary-text);
            color: var(--on-surface); padding: 4px; width: 100px; outline: none;
        }
        .manual-input:focus { border-bottom-color: var(--primary-color); }

        .generate-btn {
            width: 100%; margin-top: 24px; padding: 16px; border-radius: 50px; border: none;
            background: linear-gradient(135deg, #E2E2E2, #FFFFFF);
            color: #000; font-size: 1.1rem; font-weight: 500; cursor: pointer;
            transition: transform 0.1s, opacity 0.2s;
            box-shadow: 0 0 15px rgba(255, 255, 255, 0.1);
        }
        .generate-btn:hover { opacity: 0.9; }
        .generate-btn:active { transform: scale(0.98); }

        /* çµæœé¡¯ç¤ºå€ */
        .result-box {
            font-family: 'Roboto', sans-serif;
            display: flex; flex-direction: column; gap: 20px;
        }
        .team-card {
            background-color: transparent;
            border-left: 2px solid var(--border-color);
            padding-left: 20px;
            animation: fadeIn 0.5s ease backwards;
        }
        .team-title {
            font-size: 0.9rem; margin-bottom: 8px; color: var(--secondary-text); text-transform: uppercase; letter-spacing: 1px;
        }
        .team-member {
            margin: 6px 0; font-size: 1.1rem;
        }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }

        @media (max-width: 768px) {
            .container { flex-direction: column; }
            .card { width: auto; }
            .generate-btn { position: sticky; bottom: 20px; box-shadow: 0 4px 15px rgba(0,0,0,0.6); z-index: 10; }
        }
    </style>
</head>
<body>

<header>
    <h1>FF14 ç™¾è¬äºç±³è«¾æ—…åœ˜</h1>
    <p class="subtitle">Intelligent Team Allocation System</p>
</header>

<div class="container">
    <div class="card" style="order: 2;">
        <h2>ğŸ“ ä»»å‹™åƒæ•¸ (Parameters)</h2>
        
        <div class="input-group">
            <label>Squadron Count</label>
            <input type="number" id="teamCount" value="2" min="1">
        </div>

        <div id="roster-list" class="roster-list"></div>

        <div style="margin-top: 20px; padding-top: 15px; border-top: 1px solid var(--border-color);">
            <label style="color: var(--secondary-text); font-size: 0.8rem; margin-bottom: 10px; display:block;">External Units</label>
            <div id="manual-list" class="roster-list"></div>
        </div>

        <button class="generate-btn" onclick="generateTeams()">
            âœ§ ç”Ÿæˆæœ€ä½³åŒ–ç·¨åˆ¶
        </button>
    </div>

    <div class="card" style="order: 1;">
        <h2>ğŸ“Š åˆ†æçµæœ (Response)</h2>
        <div id="result-area" class="result-box">
            <div style="color: var(--secondary-text); margin-top: 40px; display:flex; gap:15px; align-items:flex-start;">
                <span style="font-size: 1.5rem;">âœ¨</span>
                <div style="line-height: 1.5;">
                    ä½ å¥½ï¼Œæˆ‘æ˜¯ä½ çš„å…¬æœƒåˆ†é…åŠ©æ‰‹ã€‚<br>
                    è«‹åœ¨å³å´è¨­å®šäººå“¡åå–®ï¼Œæˆ‘å°‡ç‚ºä½ è¨ˆç®—æœ€ä½³çš„åˆ†çµ„é…ç½®ã€‚
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    const PRESET_NAMES = [
        "è‰²ç´ ", "rå†·", "æ˜¥æ²", "å¸Œå¦®", "Evas", 
        "äºå­é†¬", "å¹¼ç¨šåœ’ã®Crow", "å®…K", "é˜¿è‰", "é¢¨æ„‰", "çª©ç¦"
    ];

    function init() {
        const rosterDiv = document.getElementById('roster-list');
        PRESET_NAMES.forEach((name, index) => {
            const html = `
                <div class="roster-item">
                    <input type="checkbox" id="check_${index}" class="custom-checkbox">
                    <label class="name-label" for="check_${index}">${name}</label>
                    <div class="role-selector">
                        <label><input type="radio" name="role_${index}" value="T"><span class="role-btn">T</span></label>
                        <label><input type="radio" name="role_${index}" value="H"><span class="role-btn">H</span></label>
                        <label><input type="radio" name="role_${index}" value="D" checked><span class="role-btn">D</span></label>
                    </div>
                </div>`;
            rosterDiv.insertAdjacentHTML('beforeend', html);
        });
        
        const manualDiv = document.getElementById('manual-list');
        for(let i=0; i<2; i++) {
            const mIndex = 100 + i;
            const html = `
                <div class="roster-item">
                    <input type="checkbox" id="check_${mIndex}" class="custom-checkbox">
                    <input type="text" id="name_${mIndex}" class="manual-input" placeholder="è¼¸å…¥ID">
                    <div class="role-selector" style="margin-left: auto;">
                        <label><input type="radio" name="role_${mIndex}" value="T"><span class="role-btn">T</span></label>
                        <label><input type="radio" name="role_${mIndex}" value="H"><span class="role-btn">H</span></label>
                        <label><input type="radio" name="role_${mIndex}" value="D" checked><span class="role-btn">D</span></label>
                    </div>
                </div>`;
            manualDiv.insertAdjacentHTML('beforeend', html);
        }
    }

    function generateTeams() {
        const teamCount = parseInt(document.getElementById('teamCount').value);
        const resultArea = document.getElementById('result-area');
        
        let tanks = [], healers = [], dps = [];

        // æ”¶é›†å›ºå®šåå–®
        PRESET_NAMES.forEach((name, index) => {
            if(document.getElementById(`check_${index}`).checked) {
                const role = document.querySelector(`input[name="role_${index}"]:checked`).value;
                if(role === 'T') tanks.push(name);
                else if(role === 'H') healers.push(name);
                else dps.push(name);
            }
        });

        // æ”¶é›†æ‰‹å‹•åå–®
        for(let i=0; i<2; i++) {
            const mIndex = 100 + i;
            const check = document.getElementById(`check_${mIndex}`).checked;
            const nameVal = document.getElementById(`name_${mIndex}`).value.trim();
            if(check && nameVal) {
                const role = document.querySelector(`input[name="role_${mIndex}"]:checked`).value;
                const finalName = nameVal + "(æ‰‹)";
                if(role === 'T') tanks.push(finalName);
                else if(role === 'H') healers.push(finalName);
                else dps.push(finalName);
            }
        }

        const showError = (msg) => {
            resultArea.innerHTML = `<div style="background:#3c1e1e; color:#f28b82; padding:15px; border-radius:12px; border:1px solid #f28b82;">âš ï¸ ${msg}</div>`;
        };

        const total = tanks.length + healers.length + dps.length;
        if(total === 0) return showError("è«‹è‡³å°‘å‹¾é¸ä¸€ä½å‡ºå¸­è€…");
        if(tanks.length < teamCount) return showError(`å¦å…‹ä¸è¶³ï¼šéœ€è¦ ${teamCount} ä½ï¼Œç›®å‰ ${tanks.length} ä½`);
        if(healers.length < teamCount) return showError(`è£œå¸«ä¸è¶³ï¼šéœ€è¦ ${teamCount} ä½ï¼Œç›®å‰ ${healers.length} ä½`);

        const shuffle = (arr) => arr.sort(() => Math.random() - 0.5);
        shuffle(tanks);
        shuffle(healers);
        shuffle(dps);

        let htmlOutput = "";

        for(let i=0; i<teamCount; i++) {
            const t = tanks[i];
            const h = healers[i];
            let currentTeamDps = [];
            for(let j=0; j<2; j++) {
                currentTeamDps.push(dps.length > 0 ? dps.shift() : "<span style='opacity:0.5'>(ç¼ºå“¡)</span>");
            }

            htmlOutput += `
            <div class="team-card" style="animation: fadeIn 0.5s ease backwards; animation-delay: ${i*0.1}s">
                <div class="team-title">Team 0${i+1}</div>
                <div class="team-member"><span style="color:var(--tank-color)">ğŸ›¡ï¸ ${t}</span></div>
                <div class="team-member"><span style="color:var(--healer-color)">ğŸ’š ${h}</span></div>
                <div class="team-member"><span style="color:var(--dps-color)">âš”ï¸ ${currentTeamDps.join(" , ")}</span></div>
            </div>`;
        }

        const leftTanks = tanks.slice(teamCount);
        const leftHealers = healers.slice(teamCount);
        
        if(dps.length > 0 || leftTanks.length > 0 || leftHealers.length > 0) {
            htmlOutput += `
            <div class="team-card" style="border-left-color: #555; animation: fadeIn 0.5s ease backwards; animation-delay: 0.3s">
                <div class="team-title">å€™ è£œ / å¾… æ©Ÿ</div>
                ${leftTanks.length ? `<div class="team-member" style="color:var(--tank-color)">T: ${leftTanks.join(", ")}</div>` : ""}
                ${leftHealers.length ? `<div class="team-member" style="color:var(--healer-color)">H: ${leftHealers.join(", ")}</div>` : ""}
                ${dps.length ? `<div class="team-member" style="color:var(--dps-color)">D: ${dps.join(", ")}</div>` : ""}
            </div>`;
        }

        resultArea.innerHTML = htmlOutput;
    }

    init();
</script>
</body>
</html>
